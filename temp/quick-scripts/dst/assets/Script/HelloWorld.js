
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/HelloWorld.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '280c3rsZJJKnZ9RqbALVwtK', 'HelloWorld');
// Script/HelloWorld.js

"use strict";

window._Gloabal = {
  Client_Version: "1.0.0" //客户端大版本

};

var JS_LOG = function JS_LOG() {
  var _cc;

  for (var _len = arguments.length, arg = new Array(_len), _key = 0; _key < _len; _key++) {
    arg[_key] = arguments[_key];
  }

  (_cc = cc).log.apply(_cc, ["[HelloWorld]"].concat(arg));
};

cc.Class({
  "extends": cc.Component,
  properties: {
    ModuleMagPreFab: cc.Prefab,
    moduleLayer: cc.Node,
    msgLayer: cc.Node
  },
  onDestroy: function onDestroy() {
    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);
  },
  onLoad: function onLoad() {
    var _this = this;

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);
    this.hackSysLog();
    JS_LOG("jsb_writable_:", jsb.fileUtils.getWritablePath());
    window._G_AppCom = this._AppCom = this.getComponent("AppCom"); // 配置热更新地址到 ModuleConst.js
    // 初始化

    var moduleMagObj = cc.instantiate(this.ModuleMagPreFab);
    moduleMagObj.parent = this.msgLayer;
    window._G_moduleMag = moduleMagObj.getComponent("ModuleManager");

    _G_moduleMag.initCom({
      useHotUpdate: true // 是否启用热更新 

    }); //-------------------
    // 复制包内模块到可读写路径下,避免首次加载模块时从远程完整拉取


    _G_moduleMag.execUnpackage(function () {
      _G_moduleMag.reqVersionInfo(function () {
        // 获取最新版本
        _this.reloadLobbyRoot();
      });
    }); // 定时检测更新


    _G_moduleMag.reqLoopVersionInfo();
  },
  reloadLobbyRoot: function reloadLobbyRoot() {
    var _this2 = this;

    var loadAb = ["ABLobby"]; // loadAb = ["ABLobby", "ABSubGame1", "ABSubGame2"]

    _G_moduleMag.hotUpdateMultiModule(loadAb, function () {
      // 更新模块到最新版本
      _G_moduleMag.addModule("ABLobby", function (moduleObj) {
        // 加载模块
        var abObj = moduleObj.getABObj();
        abObj.load('root/Scene/LobbyRoot', cc.Prefab, function (err, prefab) {
          // 使用模块资源 
          JS_LOG("load_lobby_prefab_:", JSON.stringify(err));

          if (_this2._lobbyRootNode) {
            _this2._lobbyRootNode.destroy();
          }

          var lobbyRoot = cc.instantiate(prefab);
          _this2._lobbyRootNode = lobbyRoot;

          _this2.moduleLayer.addChild(lobbyRoot, 100);

          lobbyRoot.getComponent("LobbyRoot").initModule();
        });
      });
    });
  },
  onKeyUp: function onKeyUp(event) {
    // 9 -- TAB  
    if (cc.sys.os == cc.sys.OS_WINDOWS && event.keyCode == 9) {
      this.hackSys_Log_Save();
    }
  },
  hackSys_Log_Save: function hackSys_Log_Save() {
    if (!this._logArr) {
      return;
    }

    ;
    var totalLen = this._logArr.length;
    var reportCo = 2000;
    var beginIdx = totalLen - reportCo;
    beginIdx = beginIdx >= 0 ? beginIdx : 0;
    var arrTemp = [];

    for (var i = beginIdx; i < totalLen; i++) {
      arrTemp.push(this._logArr[i]);
    }

    var retMsg = arrTemp.join("\n");

    if (typeof jsb != "undefined") {
      var path = ""; // path = jsb.fileUtils.getDefaultResourceRootPath()
      // if(!path){

      path = jsb.fileUtils.getWritablePath(); // }

      jsb.fileUtils.writeStringToFile(retMsg, path + "alogRecord.txt");
    }
  },
  hackSysLog: function hackSysLog() {
    var _excludeStr;

    if (this._initHackLog) {
      return;
    }

    ;
    this._initHackLog = true;
    var _logArr = [];
    this._logArr = _logArr;
    var MAX_STR_LEN = 1300;
    var excludeStr = (_excludeStr = {}, _excludeStr["Can't find letter definition in texture"] = 1, _excludeStr);

    var push_log = function push_log() {
      var ignore = false;

      for (var _len2 = arguments.length, arg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        arg[_key2] = arguments[_key2];
      }

      var logStr = arg.join(" ");
      var strLen = logStr.length;

      for (var idx = 0; idx < strLen;) {
        var endIdx = idx + MAX_STR_LEN;
        var splitStr = logStr.slice(idx, endIdx);

        for (var excStr in excludeStr) {
          if (splitStr.indexOf(excStr, 0) == 0) {
            ignore = true;
            break;
          }
        }

        if (!ignore) {
          _logArr.push("_" + _logArr.length + "_=> " + splitStr + (endIdx < strLen ? "-->" : ""));
        }

        idx = endIdx;
      }

      return ignore;
    };

    var logDef = function logDef() {
      for (var _len3 = arguments.length, arg = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        arg[_key3] = arguments[_key3];
      }

      var ignore = push_log.apply(void 0, arg);

      if (!ignore) {
        var _cc$_sv_log_2_Ori;

        (_cc$_sv_log_2_Ori = cc._sv_log_2_Ori).call.apply(_cc$_sv_log_2_Ori, [cc].concat(arg));
      }
    };

    var consoleLogDef = function consoleLogDef() {
      for (var _len4 = arguments.length, arg = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        arg[_key4] = arguments[_key4];
      }

      var ignore = push_log.apply(void 0, arg);

      if (!ignore) {
        if (cc._sv_console_2_logOri) {
          var _cc$_sv_console_2_log;

          (_cc$_sv_console_2_log = cc._sv_console_2_logOri).call.apply(_cc$_sv_console_2_log, [console].concat(arg));
        }
      }
    };

    if (!cc._sv_log_2_Ori) {
      cc._sv_log_2_Ori = cc.log;
    }

    if (!cc._sv_console_2_logOri) {
      cc._sv_console_2_logOri = console.log;
    }

    cc.log = logDef;
    console.log = consoleLogDef;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvSGVsbG9Xb3JsZC5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJfR2xvYWJhbCIsIkNsaWVudF9WZXJzaW9uIiwiSlNfTE9HIiwiYXJnIiwiY2MiLCJsb2ciLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJNb2R1bGVNYWdQcmVGYWIiLCJQcmVmYWIiLCJtb2R1bGVMYXllciIsIk5vZGUiLCJtc2dMYXllciIsIm9uRGVzdHJveSIsInN5c3RlbUV2ZW50Iiwib2ZmIiwiU3lzdGVtRXZlbnQiLCJFdmVudFR5cGUiLCJLRVlfVVAiLCJvbktleVVwIiwib25Mb2FkIiwib24iLCJoYWNrU3lzTG9nIiwianNiIiwiZmlsZVV0aWxzIiwiZ2V0V3JpdGFibGVQYXRoIiwiX0dfQXBwQ29tIiwiX0FwcENvbSIsImdldENvbXBvbmVudCIsIm1vZHVsZU1hZ09iaiIsImluc3RhbnRpYXRlIiwicGFyZW50IiwiX0dfbW9kdWxlTWFnIiwiaW5pdENvbSIsInVzZUhvdFVwZGF0ZSIsImV4ZWNVbnBhY2thZ2UiLCJyZXFWZXJzaW9uSW5mbyIsInJlbG9hZExvYmJ5Um9vdCIsInJlcUxvb3BWZXJzaW9uSW5mbyIsImxvYWRBYiIsImhvdFVwZGF0ZU11bHRpTW9kdWxlIiwiYWRkTW9kdWxlIiwibW9kdWxlT2JqIiwiYWJPYmoiLCJnZXRBQk9iaiIsImxvYWQiLCJlcnIiLCJwcmVmYWIiLCJKU09OIiwic3RyaW5naWZ5IiwiX2xvYmJ5Um9vdE5vZGUiLCJkZXN0cm95IiwibG9iYnlSb290IiwiYWRkQ2hpbGQiLCJpbml0TW9kdWxlIiwiZXZlbnQiLCJzeXMiLCJvcyIsIk9TX1dJTkRPV1MiLCJrZXlDb2RlIiwiaGFja1N5c19Mb2dfU2F2ZSIsIl9sb2dBcnIiLCJ0b3RhbExlbiIsImxlbmd0aCIsInJlcG9ydENvIiwiYmVnaW5JZHgiLCJhcnJUZW1wIiwiaSIsInB1c2giLCJyZXRNc2ciLCJqb2luIiwicGF0aCIsIndyaXRlU3RyaW5nVG9GaWxlIiwiX2luaXRIYWNrTG9nIiwiTUFYX1NUUl9MRU4iLCJleGNsdWRlU3RyIiwicHVzaF9sb2ciLCJpZ25vcmUiLCJsb2dTdHIiLCJzdHJMZW4iLCJpZHgiLCJlbmRJZHgiLCJzcGxpdFN0ciIsInNsaWNlIiwiZXhjU3RyIiwiaW5kZXhPZiIsImxvZ0RlZiIsIl9zdl9sb2dfMl9PcmkiLCJjYWxsIiwiY29uc29sZUxvZ0RlZiIsIl9zdl9jb25zb2xlXzJfbG9nT3JpIiwiY29uc29sZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQUEsTUFBTSxDQUFDQyxRQUFQLEdBQWtCO0FBQ2RDLEVBQUFBLGNBQWMsRUFBRyxPQURILENBQ2E7O0FBRGIsQ0FBbEI7O0FBSUEsSUFBSUMsTUFBTSxHQUFHLFNBQVRBLE1BQVMsR0FBZ0I7QUFBQTs7QUFBQSxvQ0FBSkMsR0FBSTtBQUFKQSxJQUFBQSxHQUFJO0FBQUE7O0FBQ3pCLFNBQUFDLEVBQUUsRUFBQ0MsR0FBSCxhQUFPLGNBQVAsU0FBeUJGLEdBQXpCO0FBQ0gsQ0FGRDs7QUFLQUMsRUFBRSxDQUFDRSxLQUFILENBQVM7QUFDTCxhQUFTRixFQUFFLENBQUNHLFNBRFA7QUFFTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLGVBQWUsRUFBR0wsRUFBRSxDQUFDTSxNQURiO0FBR1JDLElBQUFBLFdBQVcsRUFBR1AsRUFBRSxDQUFDUSxJQUhUO0FBSVJDLElBQUFBLFFBQVEsRUFBR1QsRUFBRSxDQUFDUTtBQUpOLEdBRlA7QUFVTEUsRUFBQUEsU0FWSyx1QkFVUTtBQUNUVixJQUFBQSxFQUFFLENBQUNXLFdBQUgsQ0FBZUMsR0FBZixDQUFtQlosRUFBRSxDQUFDYSxXQUFILENBQWVDLFNBQWYsQ0FBeUJDLE1BQTVDLEVBQW9ELEtBQUtDLE9BQXpELEVBQWtFLElBQWxFO0FBQ0gsR0FaSTtBQWFMQyxFQUFBQSxNQUFNLEVBQUUsa0JBQVk7QUFBQTs7QUFFaEJqQixJQUFBQSxFQUFFLENBQUNXLFdBQUgsQ0FBZU8sRUFBZixDQUFrQmxCLEVBQUUs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QkMsSUFBakIsMkJBQXNCckYsRUFBdEIsU0FBNkJELEdBQTdCO0FBQ0g7QUFDSixLQUxEOztBQU1BLFFBQUl1RixhQUFhLEdBQUcsU0FBaEJBLGFBQWdCLEdBQWdCO0FBQUEseUNBQUp2RixHQUFJO0FBQUpBLFFBQUFBLEdBQUk7QUFBQTs7QUFDaEMsVUFBSTJFLE1BQU0sR0FBR0QsUUFBUSxNQUFSLFNBQVkxRSxHQUFaLENBQWI7O0FBQ0EsVUFBRyxDQUFDMkUsTUFBSixFQUFXO0FBQ1AsWUFBRzFFLEVBQUUsQ0FBQ3VGLG9CQUFOLEVBQTRCO0FBQUE7O0FBQUUsbUNBQUF2RixFQUFFLENBQUN1RixvQkFBSCxFQUF3QkYsSUFBeEIsK0JBQTZCRyxPQUE3QixTQUF3Q3pGLEdBQXhDO0FBQStDO0FBQ2hGO0FBQ0osS0FMRDs7QUFNQSxRQUFHLENBQUNDLEVBQUUsQ0FBQ29GLGFBQVAsRUFBcUI7QUFBRXBGLE1BQUFBLEVBQUUsQ0FBQ29GLGFBQUgsR0FBbUJwRixFQUFFLENBQUNDLEdBQXRCO0FBQTRCOztBQUNuRCxRQUFHLENBQUNELEVBQUUsQ0FBQ3VGLG9CQUFQLEVBQTRCO0FBQUV2RixNQUFBQSxFQUFFLENBQUN1RixvQkFBSCxHQUEwQkMsT0FBTyxDQUFDdkYsR0FBbEM7QUFBd0M7O0FBQ3RFRCxJQUFBQSxFQUFFLENBQUNDLEdBQUgsR0FBY2tGLE1BQWQ7QUFDQUssSUFBQUEsT0FBTyxDQUFDdkYsR0FBUixHQUFjcUYsYUFBZDtBQUNIO0FBckpJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIlxuXG53aW5kb3cuX0dsb2FiYWwgPSB7IFxuICAgIENsaWVudF9WZXJzaW9uIDogXCIxLjAuMFwiICwgLy/lrqLmiLfnq6/lpKfniYjmnKxcbn1cblxubGV0IEpTX0xPRyA9IGZ1bmN0aW9uKC4uLmFyZyl7IFxuICAgIGNjLmxvZyhcIltIZWxsb1dvcmxkXVwiLC4uLmFyZykgOyBcbn1cblxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LCBcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIE1vZHVsZU1hZ1ByZUZhYiA6IGNjLlByZWZhYiAsXG5cbiAgICAgICAgbW9kdWxlTGF5ZXIgOiBjYy5Ob2RlICwgXG4gICAgICAgIG1zZ0xheWVyIDogY2MuTm9kZSAsXG5cbiAgICB9LFxuXG4gICAgb25EZXN0cm95ICgpIHsgXG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9mZihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLCB0aGlzLm9uS2V5VXAsIHRoaXMpO1xuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7ICBcblxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLCB0aGlzLm9uS2V5VXAsIHRoaXMpO1xuICAgICAgICB0aGlzLmhhY2tTeXNMb2coKVxuICAgICAgICBKU19MT0coXCJqc2Jfd3JpdGFibGVfOlwiLCBqc2IuZmlsZVV0aWxzLmdldFdyaXRhYmxlUGF0aCgpIClcblxuICAgICAgICB3aW5kb3cuX0dfQXBwQ29tID0gdGhpcy5fQXBwQ29tID0gdGhpcy5nZXRDb21wb25lbnQoXCJBcHBDb21cIilcblxuXG4gICAgICAgIC8vIOmFjee9rueDreabtOaWsOWcsOWdgOWIsCBNb2R1bGVDb25zdC5qc1xuICAgICAgICAvLyDliJ3lp4vljJZcbiAgICAgICAgbGV0IG1vZHVsZU1hZ09iaiAgICA9IGNjLmluc3RhbnRpYXRlKHRoaXMuTW9kdWxlTWFnUHJlRmFiKVxuICAgICAgICBtb2R1bGVNYWdPYmoucGFyZW50ID0gdGhpcy5tc2dMYXllciAgXG4gICAgICAgIHdpbmRvdy5fR19tb2R1bGVNYWcgPSBtb2R1bGVNYWdPYmouZ2V0Q29tcG9uZW50KFwiTW9kdWxlTWFuYWdlclwiKSAgXG4gICAgICAgIF9HX21vZHVsZU1hZy5pbml0Q29tKHtcbiAgICAgICAgICAgIHVzZUhvdFVwZGF0ZSA6IHRydWUgLCAgICAgLy8g5piv5ZCm5ZCv55So54Ot5pu05pawIFxuICAgICAgICB9KSBcbiAgICAgICAgXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgIC8vIOWkjeWItuWMheWGheaooeWdl+WIsOWPr+ivu+WGmei3r+W+hOS4iyzpgb/lhY3pppbmrKHliqDovb3mqKHlnZfml7bku47ov5znqIvlrozmlbTmi4nlj5ZcbiAgICAgICAgX0dfbW9kdWxlTWFnLmV4ZWNVbnBhY2thZ2UoKCk9PntcblxuICAgICAgICAgICAgX0dfbW9kdWxlTWFnLnJlcVZlcnNpb25JbmZvKCgpPT57IC8vIOiOt+WPluacgOaWsOeJiOacrFxuICAgICAgICAgICAgICAgIHRoaXMucmVsb2FkTG9iYnlSb290KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8g5a6a5pe25qOA5rWL5pu05pawXG4gICAgICAgIF9HX21vZHVsZU1hZy5yZXFMb29wVmVyc2lvbkluZm8oKSBcblxuICAgIH0sXG5cbiAgICByZWxvYWRMb2JieVJvb3QoKXtcblxuICAgICAgICBsZXQgbG9hZEFiID0gW1wiQUJMb2JieVwiXVxuICAgICAgICAvLyBsb2FkQWIgPSBbXCJBQkxvYmJ5XCIsIFwiQUJTdWJHYW1lMVwiLCBcIkFCU3ViR2FtZTJcIl1cbiAgICAgICAgX0dfbW9kdWxlTWFnLmhvdFVwZGF0ZU11bHRpTW9kdWxlKGxvYWRBYiwoKT0+eyAvLyDmm7TmlrDmqKHlnZfliLDmnIDmlrDniYjmnKxcblxuICAgICAgICAgICAgX0dfbW9kdWxlTWFnLmFkZE1vZHVsZShcIkFCTG9iYnlcIiwgKG1vZHVsZU9iaik9PnsgLy8g5Yqg6L295qih5Z2XXG5cbiAgICAgICAgICAgICAgICBsZXQgYWJPYmogPSBtb2R1bGVPYmouZ2V0QUJPYmooKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFiT2JqLmxvYWQoJ3Jvb3QvU2NlbmUvTG9iYnlSb290JywgY2MuUHJlZmFiLCAoZXJyLCBwcmVmYWIpPT57ICAvLyDkvb/nlKjmqKHlnZfotYTmupAgXG5cbiAgICAgICAgICAgICAgICAgICAgSlNfTE9HKFwibG9hZF9sb2JieV9wcmVmYWJfOlwiLCBKU09OLnN0cmluZ2lmeShlcnIpIClcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5fbG9iYnlSb290Tm9kZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2JieVJvb3ROb2RlLmRlc3Ryb3koKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBsb2JieVJvb3QgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpIFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2JieVJvb3ROb2RlID0gbG9iYnlSb290XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kdWxlTGF5ZXIuYWRkQ2hpbGQobG9iYnlSb290LCAxMDApXG4gICAgICAgICAgICAgICAgICAgIGxvYmJ5Um9vdC5nZXRDb21wb25lbnQoXCJMb2JieVJvb3RcIikuaW5pdE1vZHVsZSgpICAgIFxuICAgIFxuICAgICAgICAgICAgICAgIH0pIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9LFxuXG5cblxuICAgIG9uS2V5VXAoZXZlbnQpIHsgXG4gICAgICAgIC8vIDkgLS0gVEFCICBcbiAgICAgICAgaWYoY2Muc3lzLm9zPT1jYy5zeXMuT1NfV0lORE9XUyAmJiBldmVudC5rZXlDb2RlPT05KXtcbiAgICAgICAgICAgIHRoaXMuaGFja1N5c19Mb2dfU2F2ZSgpXG4gICAgICAgIH0gXG4gICAgfSxcbiAgICBoYWNrU3lzX0xvZ19TYXZlKCl7XG4gICAgICAgIGlmKCF0aGlzLl9sb2dBcnIpeyByZXR1cm4gOyB9O1xuXG4gICAgICAgIGxldCB0b3RhbExlbiA9IHRoaXMuX2xvZ0Fyci5sZW5ndGhcbiAgICAgICAgbGV0IHJlcG9ydENvID0gMjAwMFxuICAgICAgICBsZXQgYmVnaW5JZHggPSB0b3RhbExlbi1yZXBvcnRDb1xuICAgICAgICBiZWdpbklkeCA9IGJlZ2luSWR4Pj0wP2JlZ2luSWR4OjBcbiAgICAgICAgbGV0IGFyclRlbXAgPSBbXVxuXG4gICAgICAgIGZvcihsZXQgaT1iZWdpbklkeDsgaTx0b3RhbExlbjsgaSsrKXtcbiAgICAgICAgICAgIGFyclRlbXAucHVzaCh0aGlzLl9sb2dBcnJbaV0pXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmV0TXNnID0gYXJyVGVtcC5qb2luKFwiXFxuXCIpXG4gICAgICAgIGlmKHR5cGVvZiBqc2IhPVwidW5kZWZpbmVkXCIpe1xuICAgICAgICAgICAgbGV0IHBhdGggPSBcIlwiXG4gICAgICAgICAgICAvLyBwYXRoID0ganNiLmZpbGVVdGlscy5nZXREZWZhdWx0UmVzb3VyY2VSb290UGF0aCgpXG4gICAgICAgICAgICAvLyBpZighcGF0aCl7XG4gICAgICAgICAgICAgICAgcGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKClcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAganNiLmZpbGVVdGlscy53cml0ZVN0cmluZ1RvRmlsZShyZXRNc2csIHBhdGggKyBcImFsb2dSZWNvcmQudHh0XCIpXG4gICAgICAgIH1cbiAgICB9LFxuICAgIGhhY2tTeXNMb2coKXtcblxuICAgICAgICBpZih0aGlzLl9pbml0SGFja0xvZyl7IHJldHVybiA7IH0gOyB0aGlzLl9pbml0SGFja0xvZyA9IHRydWUgOyBcbiAgICAgICAgbGV0IF9sb2dBcnIgPSBbXVxuICAgICAgICB0aGlzLl9sb2dBcnIgPSBfbG9nQXJyIFxuICAgICAgICBsZXQgTUFYX1NUUl9MRU4gPSAxMzAwIFxuICAgICAgICBsZXQgZXhjbHVkZVN0ciA9IHsgW1wiQ2FuJ3QgZmluZCBsZXR0ZXIgZGVmaW5pdGlvbiBpbiB0ZXh0dXJlXCJdOjEgfSBcbiAgICAgICAgbGV0IHB1c2hfbG9nID0gZnVuY3Rpb24oLi4uYXJnKXsgIFxuICAgICAgICAgICAgbGV0IGlnbm9yZSA9IGZhbHNlXG4gICAgICAgICAgICBsZXQgbG9nU3RyID0gYXJnLmpvaW4oXCIgXCIpXG4gICAgICAgICAgICBsZXQgc3RyTGVuID0gbG9nU3RyLmxlbmd0aFxuICAgICAgICAgICAgZm9yKGxldCBpZHggPSAwO2lkeDxzdHJMZW47KXtcbiAgICAgICAgICAgICAgICBsZXQgZW5kSWR4ID0gaWR4K01BWF9TVFJfTEVOXG5cbiAgICAgICAgICAgICAgICBsZXQgc3BsaXRTdHIgPSBsb2dTdHIuc2xpY2UoaWR4LCBlbmRJZHgpXG4gICAgICAgICAgICAgICAgZm9yKGxldCBleGNTdHIgaW4gIGV4Y2x1ZGVTdHIpe1xuICAgICAgICAgICAgICAgICAgICBpZiggc3BsaXRTdHIuaW5kZXhPZihleGNTdHIsIDApID09IDAgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZSA9IHRydWUgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhayBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiggIWlnbm9yZSApe1xuICAgICAgICAgICAgICAgICAgICBfbG9nQXJyLnB1c2goXCJfXCIrX2xvZ0Fyci5sZW5ndGgrXCJfPT4gXCIrIHNwbGl0U3RyICsoZW5kSWR4PHN0ckxlbj9cIi0tPlwiOlwiXCIpKSBcbiAgICAgICAgICAgICAgICB9IFxuXG4gICAgICAgICAgICAgICAgaWR4ID0gZW5kSWR4XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgcmV0dXJuIGlnbm9yZVxuICAgICAgICB9IFxuICAgICAgICBsZXQgbG9nRGVmID0gZnVuY3Rpb24oLi4uYXJnKXsgXG4gICAgICAgICAgICBsZXQgaWdub3JlID0gcHVzaF9sb2coLi4uYXJnKVxuICAgICAgICAgICAgaWYoIWlnbm9yZSl7XG4gICAgICAgICAgICAgICAgY2MuX3N2X2xvZ18yX09yaS5jYWxsKGNjLCAuLi5hcmcpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNvbnNvbGVMb2dEZWYgPSBmdW5jdGlvbiguLi5hcmcpeyBcbiAgICAgICAgICAgIGxldCBpZ25vcmUgPSBwdXNoX2xvZyguLi5hcmcpIFxuICAgICAgICAgICAgaWYoIWlnbm9yZSl7XG4gICAgICAgICAgICAgICAgaWYoY2MuX3N2X2NvbnNvbGVfMl9sb2dPcmkpIHsgY2MuX3N2X2NvbnNvbGVfMl9sb2dPcmkuY2FsbChjb25zb2xlLC4uLmFyZyApIH1cbiAgICAgICAgICAgIH0gXG4gICAgICAgIH1cbiAgICAgICAgaWYoIWNjLl9zdl9sb2dfMl9PcmkpeyBjYy5fc3ZfbG9nXzJfT3JpID0gY2MubG9nICB9XG4gICAgICAgIGlmKCFjYy5fc3ZfY29uc29sZV8yX2xvZ09yaSl7IGNjLl9zdl9jb25zb2xlXzJfbG9nT3JpID0gY29uc29sZS5sb2cgIH1cbiAgICAgICAgY2MubG9nICAgICAgPSBsb2dEZWZcbiAgICAgICAgY29uc29sZS5sb2cgPSBjb25zb2xlTG9nRGVmXG4gICAgfSxcblxuXG59KTtcbiJdfQ==