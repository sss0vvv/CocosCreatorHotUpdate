
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/HelloWorld.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '280c3rsZJJKnZ9RqbALVwtK', 'HelloWorld');
// Script/HelloWorld.js

"use strict";

window._Gloabal = {
  Client_Version: "1.0.0" //客户端大版本

};

var JS_LOG = function JS_LOG() {
  var _cc;

  for (var _len = arguments.length, arg = new Array(_len), _key = 0; _key < _len; _key++) {
    arg[_key] = arguments[_key];
  }

  (_cc = cc).log.apply(_cc, ["[HelloWorld]"].concat(arg));
};

cc.Class({
  "extends": cc.Component,
  properties: {
    ModuleMagPreFab: cc.Prefab,
    moduleLayer: cc.Node,
    msgLayer: cc.Node
  },
  onDestroy: function onDestroy() {
    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);
  },
  onLoad: function onLoad() {
    var _this = this;

    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);
    this.hackSysLog();
    JS_LOG("jsb_writable_:", jsb.fileUtils.getWritablePath());
    window._G_AppCom = this._AppCom = this.getComponent("AppCom"); // 配置热更新地址到 ModuleConst.js
    // 初始化

    var moduleMagObj = cc.instantiate(this.ModuleMagPreFab);
    moduleMagObj.parent = this.msgLayer;
    window._G_moduleMag = moduleMagObj.getComponent("ModuleManager");

    _G_moduleMag.initCom({
      useHotUpdate: true // 是否启用热更新 

    }); //-------------------
    // 复制包内模块到可读写路径下,避免首次加载模块时从远程完整拉取


    _G_moduleMag.execUnpackage(function () {
      _G_moduleMag.reqVersionInfo(function () {
        // 获取最新版本
        _this.reloadLobbyRoot();
      });
    }); // 定时检测更新


    _G_moduleMag.reqLoopVersionInfo();
  },
  reloadLobbyRoot: function reloadLobbyRoot() {
    var _this2 = this;

    var loadAb = ["ABLobby"]; // loadAb = ["ABLobby", "ABSubGame1", "ABSubGame2"]

    _G_moduleMag.hotUpdateMultiModule(loadAb, function () {
      // 更新模块到最新版本
      _G_moduleMag.addModule("ABLobby", function (moduleObj) {
        // 加载模块
        var abObj = moduleObj.getABObj();
        abObj.load('root/Scene/LobbyRoot', cc.Prefab, function (err, prefab) {
          // 使用模块资源 
          JS_LOG("load_lobby_prefab_:", JSON.stringify(err));

          if (_this2._lobbyRootNode) {
            _this2._lobbyRootNode.destroy();
          }

          var lobbyRoot = cc.instantiate(prefab);
          _this2._lobbyRootNode = lobbyRoot;

          _this2.moduleLayer.addChild(lobbyRoot, 100);

          lobbyRoot.getComponent("LobbyRoot").initModule();
        });
      });
    });
  },
  onKeyUp: function onKeyUp(event) {
    // 9 -- TAB  
    if (cc.sys.os == cc.sys.OS_WINDOWS && event.keyCode == 9) {
      this.hackSys_Log_Save();
    }
  },
  hackSys_Log_Save: function hackSys_Log_Save() {
    if (!this._logArr) {
      return;
    }

    ;
    var totalLen = this._logArr.length;
    var reportCo = 2000;
    var beginIdx = totalLen - reportCo;
    beginIdx = beginIdx >= 0 ? beginIdx : 0;
    var arrTemp = [];

    for (var i = beginIdx; i < totalLen; i++) {
      arrTemp.push(this._logArr[i]);
    }

    var retMsg = arrTemp.join("\n");

    if (typeof jsb != "undefined") {
      var path = jsb.fileUtils.getDefaultResourceRootPath();

      if (!path) {
        path = jsb.fileUtils.getWritablePath();
      }

      jsb.fileUtils.writeStringToFile(retMsg, path + "alogRecord.txt");
    }
  },
  hackSysLog: function hackSysLog() {
    var _excludeStr;

    if (this._initHackLog) {
      return;
    }

    ;
    this._initHackLog = true;
    var _logArr = [];
    this._logArr = _logArr;
    var MAX_STR_LEN = 1300;
    var excludeStr = (_excludeStr = {}, _excludeStr["Can't find letter definition in texture"] = 1, _excludeStr);

    var push_log = function push_log() {
      var ignore = false;

      for (var _len2 = arguments.length, arg = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        arg[_key2] = arguments[_key2];
      }

      var logStr = arg.join(" ");
      var strLen = logStr.length;

      for (var idx = 0; idx < strLen;) {
        var endIdx = idx + MAX_STR_LEN;
        var splitStr = logStr.slice(idx, endIdx);

        for (var excStr in excludeStr) {
          if (splitStr.indexOf(excStr, 0) == 0) {
            ignore = true;
            break;
          }
        }

        if (!ignore) {
          _logArr.push("_" + _logArr.length + "_=> " + splitStr + (endIdx < strLen ? "-->" : ""));
        }

        idx = endIdx;
      }

      return ignore;
    };

    var logDef = function logDef() {
      for (var _len3 = arguments.length, arg = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        arg[_key3] = arguments[_key3];
      }

      var ignore = push_log.apply(void 0, arg);

      if (!ignore) {
        var _cc$_sv_log_2_Ori;

        (_cc$_sv_log_2_Ori = cc._sv_log_2_Ori).call.apply(_cc$_sv_log_2_Ori, [cc].concat(arg));
      }
    };

    var consoleLogDef = function consoleLogDef() {
      for (var _len4 = arguments.length, arg = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        arg[_key4] = arguments[_key4];
      }

      var ignore = push_log.apply(void 0, arg);

      if (!ignore) {
        if (cc._sv_console_2_logOri) {
          var _cc$_sv_console_2_log;

          (_cc$_sv_console_2_log = cc._sv_console_2_logOri).call.apply(_cc$_sv_console_2_log, [console].concat(arg));
        }
      }
    };

    if (!cc._sv_log_2_Ori) {
      cc._sv_log_2_Ori = cc.log;
    }

    if (!cc._sv_console_2_logOri) {
      cc._sv_console_2_logOri = console.log;
    }

    cc.log = logDef;
    console.log = consoleLogDef;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvSGVsbG9Xb3JsZC5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJfR2xvYWJhbCIsIkNsaWVudF9WZXJzaW9uIiwiSlNfTE9HIiwiYXJnIiwiY2MiLCJsb2ciLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJNb2R1bGVNYWdQcmVGYWIiLCJQcmVmYWIiLCJtb2R1bGVMYXllciIsIk5vZGUiLCJtc2dMYXllciIsIm9uRGVzdHJveSIsInN5c3RlbUV2ZW50Iiwib2ZmIiwiU3lzdGVtRXZlbnQiLCJFdmVudFR5cGUiLCJLRVlfVVAiLCJvbktleVVwIiwib25Mb2FkIiwib24iLCJoYWNrU3lzTG9nIiwianNiIiwiZmlsZVV0aWxzIiwiZ2V0V3JpdGFibGVQYXRoIiwiX0dfQXBwQ29tIiwiX0FwcENvbSIsImdldENvbXBvbmVudCIsIm1vZHVsZU1hZ09iaiIsImluc3RhbnRpYXRlIiwicGFyZW50IiwiX0dfbW9kdWxlTWFnIiwiaW5pdENvbSIsInVzZUhvdFVwZGF0ZSIsImV4ZWNVbnBhY2thZ2UiLCJyZXFWZXJzaW9uSW5mbyIsInJlbG9hZExvYmJ5Um9vdCIsInJlcUxvb3BWZXJzaW9uSW5mbyIsImxvYWRBYiIsImhvdFVwZGF0ZU11bHRpTW9kdWxlIiwiYWRkTW9kdWxlIiwibW9kdWxlT2JqIiwiYWJPYmoiLCJnZXRBQk9iaiIsImxvYWQiLCJlcnIiLCJwcmVmYWIiLCJKU09OIiwic3RyaW5naWZ5IiwiX2xvYmJ5Um9vdE5vZGUiLCJkZXN0cm95IiwibG9iYnlSb290IiwiYWRkQ2hpbGQiLCJpbml0TW9kdWxlIiwiZXZlbnQiLCJzeXMiLCJvcyIsIk9TX1dJTkRPV1MiLCJrZXlDb2RlIiwiaGFja1N5c19Mb2dfU2F2ZSIsIl9sb2dBcnIiLCJ0b3RhbExlbiIsImxlbmd0aCIsInJlcG9ydENvIiwiYmVnaW5JZHgiLCJhcnJUZW1wIiwiaSIsInB1c2giLCJyZXRNc2ciLCJqb2luIiwicGF0aCIsImdldERlZmF1bHRSZXNvdXJjZVJvb3RQYXRoIiwid3JpdGVTdHJpbmdUb0ZpbGUiLCJfaW5pdEhhY2tMb2ciLCJNQVhfU1RSX0xFTiIsImV4Y2x1ZGVTdHIiLCJwdXNoX2xvZyIsImlnbm9yZSIsImxvZ1N0ciIsInN0ckxlbiIsImlkeCIsImVuZElkeCIsInNwbGl0U3RyIiwic2xpY2UiLCJleGNTdHIiLCJpbmRleE9mIiwibG9nRGVmIiwiX3N2X2xvZ18yX09yaSIsImNhbGwiLCJjb25zb2xlTG9nRGVmIiwiX3N2X2NvbnNvbGVfMl9sb2dPcmkiLCJjb25zb2xlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUVBQSxNQUFNLENBQUNDLFFBQVAsR0FBa0I7QUFDZEMsRUFBQUEsY0FBYyxFQUFHLE9BREgsQ0FDYTs7QUFEYixDQUFsQjs7QUFJQSxJQUFJQyxNQUFNLEdBQUcsU0FBVEEsTUFBUyxHQUFnQjtBQUFBOztBQUFBLG9DQUFKQyxHQUFJO0FBQUpBLElBQUFBLEdBQUk7QUFBQTs7QUFDekIsU0FBQUMsRUFBRSxFQUFDQyxHQUFILGFBQU8sY0FBUCxTQUF5QkYsR0FBekI7QUFDSCxDQUZEOztBQUtBQyxFQUFFLENBQUNFLEtBQUgsQ0FBUztBQUNMLGFBQVNGLEVBQUUsQ0FBQ0csU0FEUDtBQUVMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsZUFBZSxFQUFHTCxFQUFFLENBQUNNLE1BRGI7QUFHUkMsSUFBQUEsV0FBVyxFQUFHUCxFQUFFLENBQUNRLElBSFQ7QUFJUkMsSUFBQUEsUUFBUSxFQUFHVCxFQUFFLENBQUNRO0FBSk4sR0FGUDtBQVVMRSxFQUFBQSxTQVZLLHVCQVVRO0FBQ1RWLElBQUFBLEVBQUUsQ0FBQ1csV0FBSCxDQUFlQyxHQUFmLENBQW1CWixFQUFFLENBQUNhLFdBQUgsQ0FBZUMsU0FBZixDQUF5QkMsTUFBNUMsRUFBb0QsS0FBS0MsT0FBekQsRUFBa0UsSUFBbEU7QUFDSCxHQVpJO0FBYUxDLEVBQUFBLE1BQU0sRUFBRSxrQkFBWTtBQUFBOztBQUVoQmpCLElBQUFBLEVBQUUsQ0FBQ1cs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LFVBQUcsQ0FBQzRFLE1BQUosRUFBVztBQUFBOztBQUNQLDZCQUFBM0UsRUFBRSxDQUFDcUYsYUFBSCxFQUFpQkMsSUFBakIsMkJBQXNCdEYsRUFBdEIsU0FBNkJELEdBQTdCO0FBQ0g7QUFDSixLQUxEOztBQU1BLFFBQUl3RixhQUFhLEdBQUcsU0FBaEJBLGFBQWdCLEdBQWdCO0FBQUEseUNBQUp4RixHQUFJO0FBQUpBLFFBQUFBLEdBQUk7QUFBQTs7QUFDaEMsVUFBSTRFLE1BQU0sR0FBR0QsUUFBUSxNQUFSLFNBQVkzRSxHQUFaLENBQWI7O0FBQ0EsVUFBRyxDQUFDNEUsTUFBSixFQUFXO0FBQ1AsWUFBRzNFLEVBQUUsQ0FBQ3dGLG9CQUFOLEVBQTRCO0FBQUE7O0FBQUUsbUNBQUF4RixFQUFFLENBQUN3RixvQkFBSCxFQUF3QkYsSUFBeEIsK0JBQTZCRyxPQUE3QixTQUF3QzFGLEdBQXhDO0FBQStDO0FBQ2hGO0FBQ0osS0FMRDs7QUFNQSxRQUFHLENBQUNDLEVBQUUsQ0FBQ3FGLGFBQVAsRUFBcUI7QUFBRXJGLE1BQUFBLEVBQUUsQ0FBQ3FGLGFBQUgsR0FBbUJyRixFQUFFLENBQUNDLEdBQXRCO0FBQTRCOztBQUNuRCxRQUFHLENBQUNELEVBQUUsQ0FBQ3dGLG9CQUFQLEVBQTRCO0FBQUV4RixNQUFBQSxFQUFFLENBQUN3RixvQkFBSCxHQUEwQkMsT0FBTyxDQUFDeEYsR0FBbEM7QUFBd0M7O0FBQ3RFRCxJQUFBQSxFQUFFLENBQUNDLEdBQUgsR0FBY21GLE1BQWQ7QUFDQUssSUFBQUEsT0FBTyxDQUFDeEYsR0FBUixHQUFjc0YsYUFBZDtBQUNIO0FBcEpJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIlxuXG53aW5kb3cuX0dsb2FiYWwgPSB7IFxuICAgIENsaWVudF9WZXJzaW9uIDogXCIxLjAuMFwiICwgLy/lrqLmiLfnq6/lpKfniYjmnKxcbn1cblxubGV0IEpTX0xPRyA9IGZ1bmN0aW9uKC4uLmFyZyl7IFxuICAgIGNjLmxvZyhcIltIZWxsb1dvcmxkXVwiLC4uLmFyZykgOyBcbn1cblxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LCBcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIE1vZHVsZU1hZ1ByZUZhYiA6IGNjLlByZWZhYiAsXG5cbiAgICAgICAgbW9kdWxlTGF5ZXIgOiBjYy5Ob2RlICwgXG4gICAgICAgIG1zZ0xheWVyIDogY2MuTm9kZSAsXG5cbiAgICB9LFxuXG4gICAgb25EZXN0cm95ICgpIHsgXG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9mZihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLCB0aGlzLm9uS2V5VXAsIHRoaXMpO1xuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7ICBcblxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX1VQLCB0aGlzLm9uS2V5VXAsIHRoaXMpO1xuICAgICAgICB0aGlzLmhhY2tTeXNMb2coKVxuICAgICAgICBKU19MT0coXCJqc2Jfd3JpdGFibGVfOlwiLCBqc2IuZmlsZVV0aWxzLmdldFdyaXRhYmxlUGF0aCgpIClcblxuICAgICAgICB3aW5kb3cuX0dfQXBwQ29tID0gdGhpcy5fQXBwQ29tID0gdGhpcy5nZXRDb21wb25lbnQoXCJBcHBDb21cIilcblxuXG4gICAgICAgIC8vIOmFjee9rueDreabtOaWsOWcsOWdgOWIsCBNb2R1bGVDb25zdC5qc1xuICAgICAgICAvLyDliJ3lp4vljJZcbiAgICAgICAgbGV0IG1vZHVsZU1hZ09iaiAgICA9IGNjLmluc3RhbnRpYXRlKHRoaXMuTW9kdWxlTWFnUHJlRmFiKVxuICAgICAgICBtb2R1bGVNYWdPYmoucGFyZW50ID0gdGhpcy5tc2dMYXllciAgXG4gICAgICAgIHdpbmRvdy5fR19tb2R1bGVNYWcgPSBtb2R1bGVNYWdPYmouZ2V0Q29tcG9uZW50KFwiTW9kdWxlTWFuYWdlclwiKSAgXG4gICAgICAgIF9HX21vZHVsZU1hZy5pbml0Q29tKHtcbiAgICAgICAgICAgIHVzZUhvdFVwZGF0ZSA6IHRydWUgLCAgICAgLy8g5piv5ZCm5ZCv55So54Ot5pu05pawIFxuICAgICAgICB9KSBcbiAgICAgICAgXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgIC8vIOWkjeWItuWMheWGheaooeWdl+WIsOWPr+ivu+WGmei3r+W+hOS4iyzpgb/lhY3pppbmrKHliqDovb3mqKHlnZfml7bku47ov5znqIvlrozmlbTmi4nlj5ZcbiAgICAgICAgX0dfbW9kdWxlTWFnLmV4ZWNVbnBhY2thZ2UoKCk9PntcblxuICAgICAgICAgICAgX0dfbW9kdWxlTWFnLnJlcVZlcnNpb25JbmZvKCgpPT57IC8vIOiOt+WPluacgOaWsOeJiOacrFxuICAgICAgICAgICAgICAgIHRoaXMucmVsb2FkTG9iYnlSb290KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8g5a6a5pe25qOA5rWL5pu05pawXG4gICAgICAgIF9HX21vZHVsZU1hZy5yZXFMb29wVmVyc2lvbkluZm8oKSBcblxuICAgIH0sXG5cbiAgICByZWxvYWRMb2JieVJvb3QoKXtcblxuICAgICAgICBsZXQgbG9hZEFiID0gW1wiQUJMb2JieVwiXVxuICAgICAgICAvLyBsb2FkQWIgPSBbXCJBQkxvYmJ5XCIsIFwiQUJTdWJHYW1lMVwiLCBcIkFCU3ViR2FtZTJcIl1cbiAgICAgICAgX0dfbW9kdWxlTWFnLmhvdFVwZGF0ZU11bHRpTW9kdWxlKGxvYWRBYiwoKT0+eyAvLyDmm7TmlrDmqKHlnZfliLDmnIDmlrDniYjmnKxcblxuICAgICAgICAgICAgX0dfbW9kdWxlTWFnLmFkZE1vZHVsZShcIkFCTG9iYnlcIiwgKG1vZHVsZU9iaik9PnsgLy8g5Yqg6L295qih5Z2XXG5cbiAgICAgICAgICAgICAgICBsZXQgYWJPYmogPSBtb2R1bGVPYmouZ2V0QUJPYmooKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFiT2JqLmxvYWQoJ3Jvb3QvU2NlbmUvTG9iYnlSb290JywgY2MuUHJlZmFiLCAoZXJyLCBwcmVmYWIpPT57ICAvLyDkvb/nlKjmqKHlnZfotYTmupAgXG5cbiAgICAgICAgICAgICAgICAgICAgSlNfTE9HKFwibG9hZF9sb2JieV9wcmVmYWJfOlwiLCBKU09OLnN0cmluZ2lmeShlcnIpIClcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5fbG9iYnlSb290Tm9kZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2JieVJvb3ROb2RlLmRlc3Ryb3koKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBsb2JieVJvb3QgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpIFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2JieVJvb3ROb2RlID0gbG9iYnlSb290XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kdWxlTGF5ZXIuYWRkQ2hpbGQobG9iYnlSb290LCAxMDApXG4gICAgICAgICAgICAgICAgICAgIGxvYmJ5Um9vdC5nZXRDb21wb25lbnQoXCJMb2JieVJvb3RcIikuaW5pdE1vZHVsZSgpICAgIFxuICAgIFxuICAgICAgICAgICAgICAgIH0pIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9LFxuXG5cblxuICAgIG9uS2V5VXAoZXZlbnQpIHsgXG4gICAgICAgIC8vIDkgLS0gVEFCICBcbiAgICAgICAgaWYoY2Muc3lzLm9zPT1jYy5zeXMuT1NfV0lORE9XUyAmJiBldmVudC5rZXlDb2RlPT05KXtcbiAgICAgICAgICAgIHRoaXMuaGFja1N5c19Mb2dfU2F2ZSgpXG4gICAgICAgIH0gXG4gICAgfSxcbiAgICBoYWNrU3lzX0xvZ19TYXZlKCl7XG4gICAgICAgIGlmKCF0aGlzLl9sb2dBcnIpeyByZXR1cm4gOyB9O1xuXG4gICAgICAgIGxldCB0b3RhbExlbiA9IHRoaXMuX2xvZ0Fyci5sZW5ndGhcbiAgICAgICAgbGV0IHJlcG9ydENvID0gMjAwMFxuICAgICAgICBsZXQgYmVnaW5JZHggPSB0b3RhbExlbi1yZXBvcnRDb1xuICAgICAgICBiZWdpbklkeCA9IGJlZ2luSWR4Pj0wP2JlZ2luSWR4OjBcbiAgICAgICAgbGV0IGFyclRlbXAgPSBbXVxuXG4gICAgICAgIGZvcihsZXQgaT1iZWdpbklkeDsgaTx0b3RhbExlbjsgaSsrKXtcbiAgICAgICAgICAgIGFyclRlbXAucHVzaCh0aGlzLl9sb2dBcnJbaV0pXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmV0TXNnID0gYXJyVGVtcC5qb2luKFwiXFxuXCIpXG4gICAgICAgIGlmKHR5cGVvZiBqc2IhPVwidW5kZWZpbmVkXCIpe1xuICAgICAgICAgICAgbGV0IHBhdGggPSBqc2IuZmlsZVV0aWxzLmdldERlZmF1bHRSZXNvdXJjZVJvb3RQYXRoKClcbiAgICAgICAgICAgIGlmKCFwYXRoKXtcbiAgICAgICAgICAgICAgICBwYXRoID0ganNiLmZpbGVVdGlscy5nZXRXcml0YWJsZVBhdGgoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBqc2IuZmlsZVV0aWxzLndyaXRlU3RyaW5nVG9GaWxlKHJldE1zZywgcGF0aCArIFwiYWxvZ1JlY29yZC50eHRcIilcbiAgICAgICAgfVxuICAgIH0sXG4gICAgaGFja1N5c0xvZygpe1xuXG4gICAgICAgIGlmKHRoaXMuX2luaXRIYWNrTG9nKXsgcmV0dXJuIDsgfSA7IHRoaXMuX2luaXRIYWNrTG9nID0gdHJ1ZSA7IFxuICAgICAgICBsZXQgX2xvZ0FyciA9IFtdXG4gICAgICAgIHRoaXMuX2xvZ0FyciA9IF9sb2dBcnIgXG4gICAgICAgIGxldCBNQVhfU1RSX0xFTiA9IDEzMDAgXG4gICAgICAgIGxldCBleGNsdWRlU3RyID0geyBbXCJDYW4ndCBmaW5kIGxldHRlciBkZWZpbml0aW9uIGluIHRleHR1cmVcIl06MSB9IFxuICAgICAgICBsZXQgcHVzaF9sb2cgPSBmdW5jdGlvbiguLi5hcmcpeyAgXG4gICAgICAgICAgICBsZXQgaWdub3JlID0gZmFsc2VcbiAgICAgICAgICAgIGxldCBsb2dTdHIgPSBhcmcuam9pbihcIiBcIilcbiAgICAgICAgICAgIGxldCBzdHJMZW4gPSBsb2dTdHIubGVuZ3RoXG4gICAgICAgICAgICBmb3IobGV0IGlkeCA9IDA7aWR4PHN0ckxlbjspe1xuICAgICAgICAgICAgICAgIGxldCBlbmRJZHggPSBpZHgrTUFYX1NUUl9MRU5cblxuICAgICAgICAgICAgICAgIGxldCBzcGxpdFN0ciA9IGxvZ1N0ci5zbGljZShpZHgsIGVuZElkeClcbiAgICAgICAgICAgICAgICBmb3IobGV0IGV4Y1N0ciBpbiAgZXhjbHVkZVN0cil7XG4gICAgICAgICAgICAgICAgICAgIGlmKCBzcGxpdFN0ci5pbmRleE9mKGV4Y1N0ciwgMCkgPT0gMCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlID0gdHJ1ZSBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCAhaWdub3JlICl7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dBcnIucHVzaChcIl9cIitfbG9nQXJyLmxlbmd0aCtcIl89PiBcIisgc3BsaXRTdHIgKyhlbmRJZHg8c3RyTGVuP1wiLS0+XCI6XCJcIikpIFxuICAgICAgICAgICAgICAgIH0gXG5cbiAgICAgICAgICAgICAgICBpZHggPSBlbmRJZHhcbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgICByZXR1cm4gaWdub3JlXG4gICAgICAgIH0gXG4gICAgICAgIGxldCBsb2dEZWYgPSBmdW5jdGlvbiguLi5hcmcpeyBcbiAgICAgICAgICAgIGxldCBpZ25vcmUgPSBwdXNoX2xvZyguLi5hcmcpXG4gICAgICAgICAgICBpZighaWdub3JlKXtcbiAgICAgICAgICAgICAgICBjYy5fc3ZfbG9nXzJfT3JpLmNhbGwoY2MsIC4uLmFyZylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgY29uc29sZUxvZ0RlZiA9IGZ1bmN0aW9uKC4uLmFyZyl7IFxuICAgICAgICAgICAgbGV0IGlnbm9yZSA9IHB1c2hfbG9nKC4uLmFyZykgXG4gICAgICAgICAgICBpZighaWdub3JlKXtcbiAgICAgICAgICAgICAgICBpZihjYy5fc3ZfY29uc29sZV8yX2xvZ09yaSkgeyBjYy5fc3ZfY29uc29sZV8yX2xvZ09yaS5jYWxsKGNvbnNvbGUsLi4uYXJnICkgfVxuICAgICAgICAgICAgfSBcbiAgICAgICAgfVxuICAgICAgICBpZighY2MuX3N2X2xvZ18yX09yaSl7IGNjLl9zdl9sb2dfMl9PcmkgPSBjYy5sb2cgIH1cbiAgICAgICAgaWYoIWNjLl9zdl9jb25zb2xlXzJfbG9nT3JpKXsgY2MuX3N2X2NvbnNvbGVfMl9sb2dPcmkgPSBjb25zb2xlLmxvZyAgfVxuICAgICAgICBjYy5sb2cgICAgICA9IGxvZ0RlZlxuICAgICAgICBjb25zb2xlLmxvZyA9IGNvbnNvbGVMb2dEZWZcbiAgICB9LFxuXG5cbn0pO1xuIl19