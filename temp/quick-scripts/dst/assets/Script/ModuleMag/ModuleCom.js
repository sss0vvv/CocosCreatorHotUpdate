
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/ModuleMag/ModuleCom.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'aede5xN1u9C0ou+QZmbwKN2', 'ModuleCom');
// Script/ModuleMag/ModuleCom.js

"use strict";

// let ModuleCom = require("ModuleCom")
cc.Class({
  "extends": cc.Component,
  properties: {},
  // makeXMLHttp({url: , callback:(retInfo)=>{}})
  makeXMLHttp: function makeXMLHttp(args) {
    var timeout = args.timeout,
        url = args.url,
        callback = args.callback;
    var retInfo = {};
    var isValid = true;
    var xhr = new XMLHttpRequest();
    xhr.timeout = Math.ceil((timeout || 6) * 1000);

    xhr.onreadystatechange = function () {
      if (xhr.readyState == 4 && xhr.status >= 200 && xhr.status < 400) {
        if (!isValid) {
          return;
        }

        ;
        isValid = false;
        var httpDatas = JSON.parse(xhr.responseText);
        callback({
          retData: httpDatas
        });
      } else if (xhr.readyState == 4 && xhr.status == 0) {
        if (!isValid) {
          return;
        }

        ;
        isValid = false;
        callback({
          fail: true
        });
      } else if (xhr.readyState == 4) {
        if (!isValid) {
          return;
        }

        ;
        isValid = false;
        callback({
          fail: true
        });
      }
    };

    xhr.open('GET', url, true);
    xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
    xhr.send();

    xhr.ontimeout = function () {
      if (!isValid) {
        return;
      }

      ;
      isValid = false;
      callback({
        isTimeout: true
      });
    };

    retInfo.abort = function () {
      isValid = false;
      xhr.abort();
    };

    return retInfo;
  },
  //并行任务 return : {addMis: , onFinish:}  
  // let pMis = AppComFunc.parallelMis(callback); 
  // pMis.addMis();
  // pMis.start();
  // pMis.onFinish
  parallelMis: function parallelMis(callback) {
    var co = 0;
    var ret = {};
    co = co + 1;
    var isValid = true;
    var retArgs = {};

    var onFinish = function onFinish(args) {
      if (!isValid) {
        return;
      }

      co = co - 1;

      if (args) {
        retArgs = Object.assign(retArgs, args);
      }

      if (co <= 0) {
        if (callback) {
          callback(retArgs);
        }
      }
    };

    ret.onFinish = onFinish;

    ret.addMis = function () {
      co = co + 1;
      return onFinish;
    };

    ret.start = function () {
      onFinish();
    };

    ret.close = function () {
      isValid = false;
    };

    return ret;
  },
  //顺序任务 idx:0~N,  AppComFunc.sequenceMis(misArr, onAllFolderDetectFinish, (curMis, idx, onExec)=>{ })
  sequenceMis: function sequenceMis(misArr, onAllExec, execFunc) {
    cc.log("sequenceMis__enter_:");
    var co = 0;

    var _execMis;

    _execMis = function execMis() {
      if (co >= misArr.length) {
        onAllExec();
        return;
      }

      var mis = misArr[co];
      var curCo = co;
      co = co + 1;
      execFunc(mis, curCo, _execMis);
    };

    _execMis();
  },
  // comVersion(localVer, romoteVer)
  // 对比版本号, -1:本地版本比较旧, 0:相等, 1:本地版本比较新
  comVersion: function comVersion(localVer, romoteVer) {
    var verSplit_local = localVer.split('.');
    var verSplit_remote = romoteVer.split('.');
    var localCo = verSplit_local.length;
    var remoteCo = verSplit_remote.length;
    var maxCo = localCo > remoteCo ? localCo : remoteCo;

    for (var i = 0; i < maxCo; i++) {
      var n_local = parseInt(verSplit_local[i], 10);
      var n_remote = parseInt(verSplit_remote[i], 10);

      if (i < localCo && i >= remoteCo) {
        return 1;
      } else if (i >= localCo && i < remoteCo) {
        return -1;
      } else if (n_local > n_remote) {
        return 1;
      } else if (n_local < n_remote) {
        return -1;
      }
    }

    return 0;
  },
  createUUID: function createUUID() {
    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
    var uuid = [];

    for (var i = 0; i < 4; i++) {
      uuid[i] = chars[0 | Math.random() * 36];
    }

    var uid = uuid.join('');
    uid = Number(Date.now()).toString(36) + uid;
    return uid;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvTW9kdWxlTWFnL01vZHVsZUNvbS5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm1ha2VYTUxIdHRwIiwiYXJncyIsInRpbWVvdXQiLCJ1cmwiLCJjYWxsYmFjayIsInJldEluZm8iLCJpc1ZhbGlkIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJNYXRoIiwiY2VpbCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJodHRwRGF0YXMiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJyZXREYXRhIiwiZmFpbCIsIm9wZW4iLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsIm9udGltZW91dCIsImlzVGltZW91dCIsImFib3J0IiwicGFyYWxsZWxNaXMiLCJjbyIsInJldCIsInJldEFyZ3MiLCJvbkZpbmlzaCIsIk9iamVjdCIsImFzc2lnbiIsImFkZE1pcyIsInN0YXJ0IiwiY2xvc2UiLCJzZXF1ZW5jZU1pcyIsIm1pc0FyciIsIm9uQWxsRXhlYyIsImV4ZWNGdW5jIiwibG9nIiwiZXhlY01pcyIsImxlbmd0aCIsIm1pcyIsImN1ckNvIiwiY29tVmVyc2lvbiIsImxvY2FsVmVyIiwicm9tb3RlVmVyIiwidmVyU3BsaXRfbG9jYWwiLCJzcGxpdCIsInZlclNwbGl0X3JlbW90ZSIsImxvY2FsQ28iLCJyZW1vdGVDbyIsIm1heENvIiwiaSIsIm5fbG9jYWwiLCJwYXJzZUludCIsIm5fcmVtb3RlIiwiY3JlYXRlVVVJRCIsImNoYXJzIiwidXVpZCIsInJhbmRvbSIsInVpZCIsImpvaW4iLCJOdW1iZXIiLCJEYXRlIiwibm93IiwidG9TdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQUEsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFLEVBSFA7QUFRTDtBQUNBQyxFQUFBQSxXQVRLLHVCQVNPQyxJQVRQLEVBU1k7QUFBQSxRQUVSQyxPQUZRLEdBRWtCRCxJQUZsQixDQUVSQyxPQUZRO0FBQUEsUUFFQ0MsR0FGRCxHQUVrQkYsSUFGbEIsQ0FFQ0UsR0FGRDtBQUFBLFFBRU1DLFFBRk4sR0FFa0JILElBRmxCLENBRU1HLFFBRk47QUFHYixRQUFJQyxPQUFPLEdBQUcsRUFBZDtBQUVBLFFBQUlDLE9BQU8sR0FBRyxJQUFkO0FBQ0EsUUFBSUMsR0FBRyxHQUFHLElBQUlDLGNBQUosRUFBVjtBQUNBRCxJQUFBQSxHQUFHLENBQUNMLE9BQUosR0FBY08sSUFBSSxDQUFDQyxJQUFMLENBQVUsQ0FBQ1IsT0FBTyxJQUFJLENBQVosSUFBZSxJQUF6QixDQUFkOztBQUNBSyxJQUFBQSxHQUFHLENBQUNJLGtCQUFKLEdBQXlCLFlBQVk7QUFDakMsVUFBSUosR0FBRyxDQUFDSyxVQUFKLElBQWtCLENBQWxCLElBQXdCTCxHQUFHLENBQUNNLE1BQUosSUFBYyxHQUFkLElBQXFCTixHQUFHLENBQUNNLE1BQUosR0FBYSxHQUE5RCxFQUFvRTtBQUNoRSxZQUFHLENBQUNQLE9BQUosRUFBWTtBQUFFO0FBQVE7O0FBQUM7QUFBRUEsUUFBQUEsT0FBTyxHQUFHLEtBQVY7QUFDekIsWUFBSVEsU0FBUyxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBV1QsR0FBRyxDQUFDVSxZQUFmLENBQWhCO0FBQ0FiLFFBQUFBLFFBQVEsQ0FBQztBQUFDYyxVQUFBQSxPQUFPLEVBQUNKO0FBQVQsU0FBRCxDQUFSO0FBQ0gsT0FKRCxNQUtLLElBQUlQLEdBQUcsQ0FBQ0ssVUFBSixJQUFrQixDQUFsQixJQUF1QkwsR0FBRyxDQUFDTSxNQUFKLElBQWMsQ0FBekMsRUFBNEM7QUFDN0MsWUFBRyxDQUFDUCxPQUFKLEVBQVk7QUFBRTtBQUFROztBQUFDO0FBQUVBLFFBQUFBLE9BQU8sR0FBRyxLQUFWO0FBQ3pCRixRQUFBQSxRQUFRLENBQUM7QUFBQ2UsVUFBQUEsSUFBSSxFQUFDO0FBQU4sU0FBRCxDQUFSO0FBRUgsT0FKSSxNQUlDLElBQUlaLEdBQUcsQ0FBQ0ssVUFBSixJQUFrQixDQUF0QixFQUF5QjtBQUMzQixZQUFHLENBQUNOLE9BQUosRUFBWTtBQUFFO0FBQVE7O0FBQUM7QUFBRUEsUUFBQUEsT0FBTyxHQUFHLEtBQVY7QUFDekJGLFFBQUFBLFFBQVEsQ0FBQztBQUFDZSxVQUFBQSxJQUFJLEVBQUM7QUFBTixTQUFELENBQVI7QUFDSDtBQUNKLEtBZEQ7O0FBZ0JBWixJQUFBQSxHQUFHLENBQUNhLElBQUosQ0FBUyxLQUFULEVBQWdCakIsR0FBaEIsRUFBcUIsSUFBckI7QUFDQUksSUFBQUEsR0FBRyxDQUFDYyxnQkFBSixDQUFxQixjQUFyQixFQUFxQyxnQ0FBckM7QUFDQWQsSUFBQUEsR0FBRyxDQUFDZSxJQUFKOztBQUNBZixJQUFBQSxHQUFHLENBQUNnQixTQUFKLEdBQWdCLFlBQVk7QUFDeEIsVUFBRyxDQUFDakIsT0FBSixFQUFZO0FBQUU7QUFBUTs7QUFBQztBQUFFQSxNQUFBQSxPQUFPLEdBQUcsS0FBVjtBQUN6QkYsTUFBQUEsUUFBUSxDQUFDO0FBQUNvQixRQUFBQSxTQUFTLEVBQUM7QUFBWCxPQUFELENBQVI7QUFDSCxLQUhEOztBQUlBbkIsSUFBQUEsT0FBTyxDQUFDb0IsS0FBUixHQUFnQixZQUFJO0FBQ2hCbkIsTUFBQUEsT0FBTyxHQUFHLEtBQVY7QUFDQUMsTUFBQUEsR0FBRyxDQUFDa0IsS0FBSjtBQUNILEtBSEQ7O0FBSUEsV0FBT3BCLE9BQVA7QUFDSCxHQTdDSTtBQStDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0FxQixFQUFBQSxXQXBESyx1QkFvRE90QixRQXBEUCxFQW9EZ0I7QUFDakIsUUFBSXVCLEVBQUUsR0FBRyxDQUFUO0FBQ0EsUUFBSUMsR0FBRyxHQUFHLEVBQVY7QUFDQUQsSUFBQUEsRUFBRSxHQUFHQSxFQUFFLEdBQUMsQ0FBUjtBQUNBLFFBQUlyQixPQUFPLEdBQUcsSUFBZDtBQUNBLFFBQUl1QixPQUFPLEdBQUcsRUFBZDs7QUFDQSxRQUFJQyxRQUFRLEdBQUcsU0FBWEEsUUFBVyxDQUFTN0IsSUFBVCxFQUFjO0FBQ3pCLFVBQUcsQ0FBQ0ssT0FBSixFQUFZO0FBQUU7QUFBUTs7QUFDdEJxQixNQUFBQSxFQUFFLEdBQUdBLEVBQUUsR0FBQyxDQUFSOztBQUNBLFVBQUcxQixJQUFILEVBQVE7QUFDSjRCLFFBQUFBLE9BQU8sR0FBR0UsTUFBTSxDQUFDQyxNQUFQLENBQWNILE9BQWQsRUFBdUI1QixJQUF2QixDQUFWO0FBQ0g7O0FBQ0QsVUFBRzBCLEVBQUUsSUFBRSxDQUFQLEVBQVM7QUFDTCxZQUFHdkIsUUFBSCxFQUFZO0FBQ1JBLFVBQUFBLFFBQVEsQ0FBQ3lCLE9BQUQsQ0FBUjtBQUNIO0FBQ0o7QUFDSixLQVhEOztBQVlBRCxJQUFBQSxHQUFHLENBQUNFLFFBQUosR0FBZUEsUUFBZjs7QUFDQUYsSUFBQUEsR0FBRyxDQUFDSyxNQUFKLEdBQWEsWUFBVTtBQUNuQk4sTUFBQUEsRUFBRSxHQUFHQSxFQUFFLEdBQUMsQ0FBUjtBQUNBLGFBQU9HLFFBQVA7QUFDSCxLQUhEOztBQUlBRixJQUFBQSxHQUFHLENBQUNNLEtBQUosR0FBWSxZQUFVO0FBQ2xCSixNQUFBQSxRQUFRO0FBQ1gsS0FGRDs7QUFHQUYsSUFBQUEsR0FBRyxDQUFDTyxLQUFKLEdBQVksWUFBVTtBQUNsQjdCLE1BQUFBLE9BQU8sR0FBRyxLQUFWO0FBQ0gsS0FGRDs7QUFHQSxXQUFPc0IsR0FBUDtBQUNILEdBbEZJO0FBb0ZMO0FBQ0FRLEVBQUFBLFdBckZLLHVCQXFGT0MsTUFyRlAsRUFxRmVDLFNBckZmLEVBcUYwQkMsUUFyRjFCLEVBcUZtQztBQUNwQzNDLElBQUFBLEVBQUUsQ0FBQzRDLEdBQUgsQ0FBTyxzQkFBUDtBQUNBLFFBQUliLEVBQUUsR0FBRyxDQUFUOztBQUNBLFFBQUljLFFBQUo7O0FBQ0FBLElBQUFBLFFBQU8sR0FBRyxtQkFBSTtBQUNWLFVBQUdkLEVBQUUsSUFBRVUsTUFBTSxDQUFDSyxNQUFkLEVBQXFCO0FBQ2pCSixRQUFBQSxTQUFTO0FBQ1Q7QUFDSDs7QUFDRCxVQUFJSyxHQUFHLEdBQUdOLE1BQU0sQ0FBQ1YsRUFBRCxDQUFoQjtBQUNBLFVBQUlpQixLQUFLLEdBQUdqQixFQUFaO0FBQ0FBLE1BQUFBLEVBQUUsR0FBQ0EsRUFBRSxHQUFDLENBQU47QUFDQVksTUFBQUEsUUFBUSxDQUFDSSxHQUFELEVBQU1DLEtBQU4sRUFBYUgsUUFBYixDQUFSO0FBQ0gsS0FURDs7QUFVQUEsSUFBQUEsUUFBTztBQUNWLEdBcEdJO0FBc0dMO0FBQ0E7QUFDQUksRUFBQUEsVUF4R0ssc0JBd0dNQyxRQXhHTixFQXdHZ0JDLFNBeEdoQixFQXdHMEI7QUFDM0IsUUFBSUMsY0FBYyxHQUFJRixRQUFRLENBQUNHLEtBQVQsQ0FBZSxHQUFmLENBQXRCO0FBQ0EsUUFBSUMsZUFBZSxHQUFHSCxTQUFTLENBQUNFLEtBQVYsQ0FBZ0IsR0FBaEIsQ0FBdEI7QUFDQSxRQUFJRSxPQUFPLEdBQUlILGNBQWMsQ0FBQ04sTUFBOUI7QUFDQSxRQUFJVSxRQUFRLEdBQUdGLGVBQWUsQ0FBQ1IsTUFBL0I7QUFDQSxRQUFJVyxLQUFLLEdBQUdGLE9BQU8sR0FBQ0MsUUFBUixHQUFpQkQsT0FBakIsR0FBMkJDLFFBQXZDOztBQUVBLFNBQUksSUFBSUUsQ0FBQyxHQUFDLENBQVYsRUFBWUEsQ0FBQyxHQUFDRCxLQUFkLEVBQW9CQyxDQUFDLEVBQXJCLEVBQXdCO0FBQ3BCLFVBQUlDLE9BQU8sR0FBR0MsUUFBUSxDQUFDUixjQUFjLENBQUNNLENBQUQsQ0FBZixFQUFvQixFQUFwQixDQUF0QjtBQUNBLFVBQUlHLFFBQVEsR0FBR0QsUUFBUSxDQUFDTixlQUFlLENBQUNJLENBQUQsQ0FBaEIsRUFBcUIsRUFBckIsQ0FBdkI7O0FBRUEsVUFBR0EsQ0FBQyxHQUFDSCxPQUFGLElBQWFHLENBQUMsSUFBRUYsUUFBbkIsRUFBNEI7QUFBRSxlQUFPLENBQVA7QUFBVSxPQUF4QyxNQUNLLElBQUdFLENBQUMsSUFBRUgsT0FBSCxJQUFjRyxDQUFDLEdBQUNGLFFBQW5CLEVBQTZCO0FBQUUsZUFBTyxDQUFDLENBQVI7QUFBVSxPQUF6QyxNQUNBLElBQUdHLE9BQU8sR0FBQ0UsUUFBWCxFQUFvQjtBQUFFLGVBQU8sQ0FBUDtBQUFTLE9BQS9CLE1BQ0EsSUFBR0YsT0FBTyxHQUFDRSxRQUFYLEVBQW9CO0FBQUUsZUFBTyxDQUFDLENBQVI7QUFBVTtBQUN4Qzs7QUFDRCxXQUFPLENBQVA7QUFDSCxHQXpISTtBQTBITEMsRUFBQUEsVUExSEssd0JBMEhPO0FBQ1IsUUFBSUMsS0FBSyxHQUFHLGlFQUFpRVYsS0FBakUsQ0FBdUUsRUFBdkUsQ0FBWjtBQUNBLFFBQUlXLElBQUksR0FBRyxFQUFYOztBQUNBLFNBQUssSUFBSU4sQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRyxDQUFwQixFQUF1QkEsQ0FBQyxFQUF4QixFQUE0QjtBQUN4Qk0sTUFBQUEsSUFBSSxDQUFDTixDQUFELENBQUosR0FBVUssS0FBSyxDQUFDLElBQUlsRCxJQUFJLENBQUNvRCxNQUFMLEtBQWMsRUFBbkIsQ0FBZjtBQUNIOztBQUNELFFBQUlDLEdBQUcsR0FBR0YsSUFBSSxDQUFDRyxJQUFMLENBQVUsRUFBVixDQUFWO0FBQ0FELElBQUFBLEdBQUcsR0FBR0UsTUFBTSxDQUFDQyxJQUFJLENBQUNDLEdBQUwsRUFBRCxDQUFOLENBQW1CQyxRQUFuQixDQUE0QixFQUE1QixJQUFrQ0wsR0FBeEM7QUFDQSxXQUFPQSxHQUFQO0FBQ0g7QUFuSUksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiXG4vLyBsZXQgTW9kdWxlQ29tID0gcmVxdWlyZShcIk1vZHVsZUNvbVwiKVxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcblxuXG4gICAgfSxcblxuICAgIC8vIG1ha2VYTUxIdHRwKHt1cmw6ICwgY2FsbGJhY2s6KHJldEluZm8pPT57fX0pXG4gICAgbWFrZVhNTEh0dHAoYXJncyl7XG5cbiAgICAgICAgbGV0IHt0aW1lb3V0LCB1cmwsIGNhbGxiYWNrfSA9IGFyZ3NcbiAgICAgICAgbGV0IHJldEluZm8gPSB7fVxuXG4gICAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZVxuICAgICAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci50aW1lb3V0ID0gTWF0aC5jZWlsKCh0aW1lb3V0IHx8IDYpKjEwMDApO1xuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgNDAwKSkge1xuICAgICAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXsgcmV0dXJuIH0gOyBpc1ZhbGlkID0gZmFsc2UgXG4gICAgICAgICAgICAgICAgdmFyIGh0dHBEYXRhcyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7IFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHtyZXREYXRhOmh0dHBEYXRhc30pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmIHhoci5zdGF0dXMgPT0gMCkge1xuICAgICAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXsgcmV0dXJuIH0gOyBpc1ZhbGlkID0gZmFsc2UgIFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHtmYWlsOnRydWV9KVxuXG4gICAgICAgICAgICB9ZWxzZSBpZiAoeGhyLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgICAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXsgcmV0dXJuIH0gOyBpc1ZhbGlkID0gZmFsc2UgIFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHtmYWlsOnRydWV9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7IFxuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCcpOyBcbiAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXsgcmV0dXJuIH0gOyBpc1ZhbGlkID0gZmFsc2UgIFxuICAgICAgICAgICAgY2FsbGJhY2soe2lzVGltZW91dDp0cnVlfSlcbiAgICAgICAgfTsgXG4gICAgICAgIHJldEluZm8uYWJvcnQgPSAoKT0+e1xuICAgICAgICAgICAgaXNWYWxpZCA9IGZhbHNlXG4gICAgICAgICAgICB4aHIuYWJvcnQoKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXRJbmZvXG4gICAgfSxcblxuICAgIC8v5bm26KGM5Lu75YqhIHJldHVybiA6IHthZGRNaXM6ICwgb25GaW5pc2g6fSAgXG4gICAgLy8gbGV0IHBNaXMgPSBBcHBDb21GdW5jLnBhcmFsbGVsTWlzKGNhbGxiYWNrKTsgXG4gICAgLy8gcE1pcy5hZGRNaXMoKTtcbiAgICAvLyBwTWlzLnN0YXJ0KCk7XG4gICAgLy8gcE1pcy5vbkZpbmlzaFxuICAgIHBhcmFsbGVsTWlzKGNhbGxiYWNrKXtcbiAgICAgICAgbGV0IGNvID0gMDtcbiAgICAgICAgbGV0IHJldCA9IHt9O1xuICAgICAgICBjbyA9IGNvKzE7XG4gICAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZVxuICAgICAgICBsZXQgcmV0QXJncyA9IHt9XG4gICAgICAgIGxldCBvbkZpbmlzaCA9IGZ1bmN0aW9uKGFyZ3Mpe1xuICAgICAgICAgICAgaWYoIWlzVmFsaWQpeyByZXR1cm4gfVxuICAgICAgICAgICAgY28gPSBjby0xO1xuICAgICAgICAgICAgaWYoYXJncyl7XG4gICAgICAgICAgICAgICAgcmV0QXJncyA9IE9iamVjdC5hc3NpZ24ocmV0QXJncywgYXJncylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGNvPD0wKXtcbiAgICAgICAgICAgICAgICBpZihjYWxsYmFjayl7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJldEFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXQub25GaW5pc2ggPSBvbkZpbmlzaDtcbiAgICAgICAgcmV0LmFkZE1pcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjbyA9IGNvKzE7XG4gICAgICAgICAgICByZXR1cm4gb25GaW5pc2g7XG4gICAgICAgIH1cbiAgICAgICAgcmV0LnN0YXJ0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIG9uRmluaXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0LmNsb3NlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIC8v6aG65bqP5Lu75YqhIGlkeDowfk4sICBBcHBDb21GdW5jLnNlcXVlbmNlTWlzKG1pc0Fyciwgb25BbGxGb2xkZXJEZXRlY3RGaW5pc2gsIChjdXJNaXMsIGlkeCwgb25FeGVjKT0+eyB9KVxuICAgIHNlcXVlbmNlTWlzKG1pc0Fyciwgb25BbGxFeGVjLCBleGVjRnVuYyl7XG4gICAgICAgIGNjLmxvZyhcInNlcXVlbmNlTWlzX19lbnRlcl86XCIpXG4gICAgICAgIGxldCBjbyA9IDBcbiAgICAgICAgbGV0IGV4ZWNNaXMgO1xuICAgICAgICBleGVjTWlzID0gKCk9PntcbiAgICAgICAgICAgIGlmKGNvPj1taXNBcnIubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICBvbkFsbEV4ZWMoKVxuICAgICAgICAgICAgICAgIHJldHVybiBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBtaXMgPSBtaXNBcnJbY29dXG4gICAgICAgICAgICBsZXQgY3VyQ28gPSBjb1xuICAgICAgICAgICAgY289Y28rMSBcbiAgICAgICAgICAgIGV4ZWNGdW5jKG1pcywgY3VyQ28sIGV4ZWNNaXMpXG4gICAgICAgIH0gXG4gICAgICAgIGV4ZWNNaXMoKSBcbiAgICB9LFxuXG4gICAgLy8gY29tVmVyc2lvbihsb2NhbFZlciwgcm9tb3RlVmVyKVxuICAgIC8vIOWvueavlOeJiOacrOWPtywgLTE65pys5Zyw54mI5pys5q+U6L6D5penLCAwOuebuOetiSwgMTrmnKzlnLDniYjmnKzmr5TovoPmlrBcbiAgICBjb21WZXJzaW9uKGxvY2FsVmVyLCByb21vdGVWZXIpe1xuICAgICAgICBsZXQgdmVyU3BsaXRfbG9jYWwgID0gbG9jYWxWZXIuc3BsaXQoJy4nKVxuICAgICAgICBsZXQgdmVyU3BsaXRfcmVtb3RlID0gcm9tb3RlVmVyLnNwbGl0KCcuJylcbiAgICAgICAgbGV0IGxvY2FsQ28gID0gdmVyU3BsaXRfbG9jYWwubGVuZ3RoXG4gICAgICAgIGxldCByZW1vdGVDbyA9IHZlclNwbGl0X3JlbW90ZS5sZW5ndGhcbiAgICAgICAgbGV0IG1heENvID0gbG9jYWxDbz5yZW1vdGVDbz9sb2NhbENvIDogcmVtb3RlQ29cbiAgICAgICAgXG4gICAgICAgIGZvcihsZXQgaT0wO2k8bWF4Q287aSsrKXtcbiAgICAgICAgICAgIGxldCBuX2xvY2FsID0gcGFyc2VJbnQodmVyU3BsaXRfbG9jYWxbaV0sIDEwKTsgXG4gICAgICAgICAgICBsZXQgbl9yZW1vdGUgPSBwYXJzZUludCh2ZXJTcGxpdF9yZW1vdGVbaV0sIDEwKTsgXG5cbiAgICAgICAgICAgIGlmKGk8bG9jYWxDbyAmJiBpPj1yZW1vdGVDbyl7IHJldHVybiAxIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaT49bG9jYWxDbyAmJiBpPHJlbW90ZUNvKSB7IHJldHVybiAtMX0gXG4gICAgICAgICAgICBlbHNlIGlmKG5fbG9jYWw+bl9yZW1vdGUpeyByZXR1cm4gMX1cbiAgICAgICAgICAgIGVsc2UgaWYobl9sb2NhbDxuX3JlbW90ZSl7IHJldHVybiAtMX1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMFxuICAgIH0sXG4gICAgY3JlYXRlVVVJRCgpe1xuICAgICAgICB2YXIgY2hhcnMgPSAnMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLnNwbGl0KCcnKTsgXG4gICAgICAgIHZhciB1dWlkID0gW107ICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIHV1aWRbaV0gPSBjaGFyc1swIHwgTWF0aC5yYW5kb20oKSozNl07XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHVpZCA9IHV1aWQuam9pbignJyk7XG4gICAgICAgIHVpZCA9IE51bWJlcihEYXRlLm5vdygpKS50b1N0cmluZygzNikgKyB1aWQgXG4gICAgICAgIHJldHVybiB1aWRcbiAgICB9LFxuXG5cbn0pOyBcbiJdfQ==